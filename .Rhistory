freq_scaled <- (log(freq + 1) / log(max(freq) + 1))
size_scaled <- 1 + 10 * freq_scaled
n_pop <- ncol(freq)
cols <- brewer.pal(min(n_pop, 8), "Set2")
par(mar = c(3, 3, 3, 3))
plot(
net,
size = size_scaled,
bg = cols,
pie = pie,
show.mutation = 0,
scale.ratio = 10,
asp = 0.3,
labels = FALSE,
fast = TRUE
)
legend(
"topleft",
legend = colnames(pie),
col = cols,
pch = 15,
ncol = 1
# pt.cex = 1.5,
# bty="n"
)
freq <- attr(net, "freq")
freq_scaled <- (log(freq + 1) / log(max(freq) + 1))
size_scaled <- 1 + 2 * freq_scaled
n_pop <- ncol(freq)
cols <- brewer.pal(min(n_pop, 8), "Set2")
par(mar = c(3, 3, 3, 3))
plot(
net,
size = size_scaled,
bg = cols,
pie = pie,
show.mutation = 0,
scale.ratio = 5,
asp = 0.3,
labels = FALSE,
fast = TRUE
)
legend(
"topleft",
legend = colnames(pie),
col = cols,
pch = 15,
ncol = 1
# pt.cex = 1.5,
# bty="n"
)
freq <- attr(net, "freq")
# freq_scaled <- (log(freq + 1) / log(max(freq) + 1))
# size_scaled <- 1 + 2 * freq_scaled
n_pop <- ncol(freq)
cols <- brewer.pal(min(n_pop, 8), "Set2")
par(mar = c(3, 3, 3, 3))
plot(
net,
size = freq,
bg = cols,
pie = pie,
show.mutation = 0,
scale.ratio = 5,
asp = 0.3,
labels = FALSE,
fast = TRUE
)
legend(
"topleft",
legend = colnames(pie),
col = cols,
pch = 15,
ncol = 1
# pt.cex = 1.5,
# bty="n"
)
freq <- attr(net, "freq")
# freq_scaled <- (log(freq + 1) / log(max(freq) + 1))
# size_scaled <- 1 + 2 * freq_scaled
n_pop <- ncol(freq)
cols <- brewer.pal(min(n_pop, 8), "Set2")
par(mar = c(3, 3, 3, 3))
plot(
net,
size = freq,
bg = cols,
pie = pie,
show.mutation = 1,
scale.ratio = 5,
asp = 0.3,
labels = FALSE,
fast = TRUE
)
legend(
"topleft",
legend = colnames(pie),
col = cols,
pch = 15,
ncol = 1
# pt.cex = 1.5,
# bty="n"
)
freq <- attr(net, "freq")
# freq_scaled <- (log(freq + 1) / log(max(freq) + 1))
# size_scaled <- 1 + 2 * freq_scaled
n_pop <- ncol(freq)
cols <- brewer.pal(min(n_pop, 8), "Set2")
par(mar = c(3, 3, 3, 3))
plot(
net,
size = freq,
bg = cols,
pie = pie,
show.mutation = 1,
scale.ratio = 5,
asp = 0.5,
labels = FALSE,
fast = TRUE
)
legend(
"topleft",
legend = colnames(pie),
col = cols,
pch = 15,
ncol = 1
# pt.cex = 1.5,
# bty="n"
)
freq <- attr(net, "freq")
freq_scaled <- (log(freq + 1) / log(max(freq) + 1))
size_scaled <- 1 + 2 * freq_scaled
n_pop <- ncol(freq)
cols <- brewer.pal(min(n_pop, 8), "Set2")
par(mar = c(3, 3, 3, 3))
plot(
net,
size = size_scaled,
bg = cols,
pie = pie,
show.mutation = 1,
scale.ratio = 5,
asp = 0.5,
labels = FALSE,
fast = TRUE
)
legend(
"topleft",
legend = colnames(pie),
col = cols,
pch = 15,
ncol = 1
# pt.cex = 1.5,
# bty="n"
)
freq <- attr(net, "freq")
freq_scaled <- (log(freq + 1) / log(max(freq) + 1))
size_scaled <- 1 + 8 * freq_scaled
n_pop <- ncol(freq)
cols <- brewer.pal(min(n_pop, 8), "Set2")
par(mar = c(3, 3, 3, 3))
plot(
net,
size = size_scaled,
bg = cols,
pie = pie,
show.mutation = 1,
scale.ratio = 5,
asp = 1,
labels = FALSE,
fast = TRUE
)
legend(
"topleft",
legend = colnames(pie),
col = cols,
pch = 15,
ncol = 1
# pt.cex = 1.5,
# bty="n"
)
freq <- attr(net, "freq")
freq_scaled <- (log(freq + 1) / log(max(freq) + 1))
size_scaled <- 1 + 8 * freq_scaled
n_pop <- ncol(freq)
cols <- brewer.pal(min(n_pop, 8), "Set2")
par(mar = c(3, 3, 3, 3))
plot(
net,
size = size_scaled,
bg = cols,
pie = pie,
show.mutation = 1,
scale.ratio = 3,
asp = 0.5,
labels = FALSE,
fast = TRUE
)
legend(
"topleft",
legend = colnames(pie),
col = cols,
pch = 15,
ncol = 1
# pt.cex = 1.5,
# bty="n"
)
freq <- attr(net, "freq")
freq_scaled <- (log(freq + 1) / log(max(freq) + 1))
size_scaled <- 1 + 8 * freq_scaled
n_pop <- ncol(freq)
cols <- brewer.pal(min(n_pop, 8), "Set2")
par(mar = c(3, 3, 3, 3))
plot(
net,
size = size_scaled,
bg = cols,
pie = pie,
show.mutation = 0,
scale.ratio = 3,
asp = 0.5,
labels = FALSE,
fast = TRUE
)
legend(
"topleft",
legend = colnames(pie),
col = cols,
pch = 15,
ncol = 1
# pt.cex = 1.5,
# bty="n"
)
freq <- attr(net, "freq")
freq_scaled <- (log(freq + 1) / log(max(freq) + 1))
size_scaled <- 1 + 8 * freq_scaled
n_pop <- ncol(freq)
cols <- brewer.pal(min(n_pop, 8), "Set2")
par(mar = c(3, 3, 3, 3))
plot(
net,
size = size_scaled,
bg = cols,
pie = pie,
show.mutation = 0,
scale.ratio = 3,
asp = 0.5,
labels = FALSE,
fast = TRUE
)
legend(
"topleft",
legend = colnames(pie),
col = cols,
pch = 15,
ncol = 1,
pt.cex = 1.5,
bty="n"
)
freq <- attr(net, "freq")
freq_scaled <- (log(freq + 1) / log(max(freq) + 1))
size_scaled <- 1 + 8 * freq_scaled
n_pop <- ncol(freq)
cols <- brewer.pal(min(n_pop, 8), "Set2")
par(mar = c(3, 3, 3, 3))
plot(
net,
size = size_scaled,
bg = cols,
pie = pie,
show.mutation = 0,
scale.ratio = 6,
asp = 0.5,
labels = FALSE,
fast = TRUE
)
legend(
"topleft",
legend = colnames(pie),
col = cols,
pch = 15,
ncol = 1,
pt.cex = 1.5,
bty="n"
)
freq <- attr(net, "freq")
freq_scaled <- (log(freq + 1) / log(max(freq) + 1))
size_scaled <- 1 + 20 * freq_scaled
n_pop <- ncol(freq)
cols <- brewer.pal(min(n_pop, 8), "Set2")
par(mar = c(3, 3, 3, 3))
plot(
net,
size = size_scaled,
bg = cols,
pie = pie,
show.mutation = 0,
scale.ratio = 6,
asp = 0.5,
labels = FALSE,
fast = TRUE
)
legend(
"topleft",
legend = colnames(pie),
col = cols,
pch = 15,
ncol = 1,
pt.cex = 1.5,
bty="n"
)
freq <- attr(net, "freq")
freq_scaled <- (log(freq + 1) / log(max(freq) + 1))
size_scaled <- 1 + 20 * freq_scaled
n_pop <- ncol(freq)
cols <- brewer.pal(min(n_pop, 8), "Set2")
par(mar = c(3, 3, 3, 3))
plot(
net,
size = size_scaled,
bg = cols,
pie = pie,
show.mutation = 3,
scale.ratio = 6,
asp = 0.5,
labels = FALSE,
fast = TRUE
)
legend(
"topleft",
legend = colnames(pie),
col = cols,
pch = 15,
ncol = 1,
pt.cex = 1.5,
bty="n"
)
library(pegas)
library(knitr)
library(ape)
library(tidyverse)
# dna <- read.nexus.data("/Users/henrysun_1/Desktop/Duke/PhD 2025-2026/callinectes_co1/processed/combined_unique_trimmed.nexus")
dna <- read.dna("/Users/henrysun_1/Desktop/Duke/PhD 2025-2026/callinectes_co1/processed/combined_unique_trimmed.fasta", format="fasta")
traits <- read.csv("/Users/henrysun_1/Desktop/Duke/PhD 2025-2026/callinectes_co1/processed/population_traits.csv")
library(pegas)
library(knitr)
library(ape)
library(tidyverse)
library(RColorBrewer)
library(igraph)
setwd("/Users/henrysun_1/Desktop/Duke/PhD 2025-2026/callinectes_co1")
getwd()
# dna <- read.nexus.data("/Users/henrysun_1/Desktop/Duke/PhD 2025-2026/callinectes_co1/processed/combined_unique_trimmed.nexus")
dna <- read.dna("/Users/henrysun_1/Desktop/Duke/PhD 2025-2026/callinectes_co1/processed/combined_unique_trimmed.fasta", format="fasta")
traits <- read.csv("/Users/henrysun_1/Desktop/Duke/PhD 2025-2026/callinectes_co1/processed/population_traits.csv")
hap <- haplotype(dna)
hapInfo <- stack(setNames(attr(hap,"index"),rownames(hap)))
names(hapInfo) <- c("index","haplotype")
hapInfo$index
merged <- data.frame(cbind(hapInfo,traits[hapInfo$index,]))
pie <- table(merged$haplotype,merged$Population)
net <- haploNet(hap)
freq <- attr(net, "freq")
freq_scaled <- (log(freq + 1) / log(max(freq) + 1))
size_scaled <- 1 + 20 * freq_scaled
n_pop <- ncol(freq)
cols <- brewer.pal(min(n_pop, 8), "Set2")
par(mar = c(3, 3, 3, 3))
plot(
net,
size = size_scaled,
bg = cols,
pie = pie,
show.mutation = 3,
scale.ratio = 6,
asp = 0.5,
labels = FALSE,
fast = TRUE
)
legend(
"topleft",
legend = colnames(pie),
col = cols,
pch = 15,
ncol = 1,
pt.cex = 1.5,
bty="n"
)
freq <- attr(net, "freq")
freq_scaled <- (log(freq + 1) / log(max(freq) + 1))
size_scaled <- 1 + 20 * freq_scaled
n_pop <- ncol(freq)
cols <- brewer.pal(min(n_pop, 8), "Set2")
par(mar = c(3, 3, 3, 3))
plot(
net,
size = size_scaled,
bg = cols,
pie = pie,
show.mutation = 3,
scale.ratio = 100,
asp = 0.5,
labels = FALSE,
fast = TRUE
)
legend(
"topleft",
legend = colnames(pie),
col = cols,
pch = 15,
ncol = 1,
pt.cex = 1.5,
bty="n"
)
freq <- attr(net, "freq")
freq_scaled <- (log(freq + 1) / log(max(freq) + 1))
size_scaled <- 1 + 20 * freq_scaled
n_pop <- ncol(freq)
cols <- brewer.pal(min(n_pop, 8), "Set2")
par(mar = c(3, 3, 3, 3))
plot(
net,
size = size_scaled,
bg = cols,
pie = pie,
show.mutation = 3,
scale.ratio = 30,
asp = 0.5,
labels = FALSE,
fast = TRUE
)
legend(
"topleft",
legend = colnames(pie),
col = cols,
pch = 15,
ncol = 1,
pt.cex = 1.5,
bty="n"
)
freq <- attr(net, "freq")
freq_scaled <- (log(freq + 1) / log(max(freq) + 1))
size_scaled <- 1 + 20 * freq_scaled
n_pop <- ncol(freq)
cols <- brewer.pal(min(n_pop, 8), "Set2")
par(mar = c(3, 3, 3, 3))
plot(
net,
size = size_scaled,
bg = cols,
pie = pie,
show.mutation = 0,
scale.ratio = 30,
asp = 0.5,
labels = FALSE,
fast = TRUE
)
legend(
"topleft",
legend = colnames(pie),
col = cols,
pch = 15,
ncol = 1,
pt.cex = 1.5,
bty="n"
)
freq <- attr(net, "freq")
freq_scaled <- (log(freq + 1) / log(max(freq) + 1))
size_scaled <- 1 + 20 * freq_scaled
n_pop <- ncol(freq)
cols <- brewer.pal(min(n_pop, 8), "Set2")
par(mar = c(3, 3, 3, 3))
plot(
net,
size = size_scaled,
bg = cols,
pie = pie,
show.mutation = 0,
scale.ratio = 30,
asp = 1,
labels = FALSE,
fast = TRUE
)
legend(
"topleft",
legend = colnames(pie),
col = cols,
pch = 15,
ncol = 1,
pt.cex = 1.5,
bty="n"
)
View(hapInfo)
View(traits)
View(pop)
View(g)
hap <- haplotype(dna)
hapInfo <- stack(setNames(attr(hap,"index"),rownames(hap)))
names(hapInfo) <- c("index","haplotype")
hapInfo$index
merged <- data.frame(cbind(hapInfo,traits[hapInfo$index,]))
pie <- table(merged$haplotype,merged$Population)
net <- haploNet(hap)
net
print.default(net)
hap
hapInfo
merged
setwd("/Users/henrysun_1/Desktop/Duke/PhD 2025-2026/callinectes_co1")
merged.to_csv("processed/traits.csv")
setwd("/Users/henrysun_1/Desktop/Duke/PhD 2025-2026/callinectes_co1")
write.csv(merged, "processed/traits.csv")
